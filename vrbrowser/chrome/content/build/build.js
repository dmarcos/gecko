!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){var n=AFRAME.utils.bind;if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var i={CLICK:"click",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},r={HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"};AFRAME.registerComponent("controller-cursor",{dependencies:["raycaster"],schema:{color:{default:"#74BEC1"},radius:{default:.001}},init:function(){var e=this.el,t=this.data;if(this.triggerDownEl=null,this.intersection=null,this.intersectedEl=null,!e.sceneEl.canvas)return void e.sceneEl.addEventListener("render-target-loaded",n(this.init,this));e.setAttribute("raycaster",{near:.03});var i=e.getAttribute("raycaster").far,r=i===1/0?1e3:i,o=new THREE.CylinderBufferGeometry(t.radius,t.radius,r,32),s=new THREE.MeshBasicMaterial({color:t.color}),a=new THREE.Mesh(o,s);a.position.z=-1*r/2,a.rotation.x=Math.PI/180*90,e.setObject3D("cursormesh",a),this.onIntersectionBind=n(this.onIntersection,this),this.onIntersectionClearedBind=n(this.onIntersectionCleared,this),this.onTriggerDownBind=n(this.onTriggerDown,this),this.onTriggerUpBind=n(this.onTriggerUp,this)},play:function(){var e=this.el;e.addEventListener("raycaster-intersection",this.onIntersectionBind),e.addEventListener("raycaster-intersection-cleared",this.onIntersectionClearedBind),e.addEventListener("triggerdown",this.onTriggerDownBind),e.addEventListener("triggerup",this.onTriggerUpBind)},pause:function(){var e=this.el;e.removeEventListener("raycaster-intersection",this.onIntersectionBind),e.removeEventListener("raycaster-intersection-cleared",this.onIntersectionClearedBind),e.removeEventListener("triggerdown",this.onTriggerDownBind),e.removeEventListener("triggerup",this.onTriggerUpBind)},onTriggerDown:function(e){this.twoWayEmit(i.MOUSEDOWN),this.triggerDownEl=this.intersectedEl},onTriggerUp:function(e){this.twoWayEmit(i.MOUSEUP),this.intersectedEl&&this.triggerDownEl===this.intersectedEl&&this.twoWayEmit(i.CLICK)},onIntersection:function(e){var t,n,o,s=this,a=this.el;if(t=e.detail.els[0]===a?1:0,o=e.detail.intersections[t],n=e.detail.els[t]){if(this.intersectedEl===n)return void(this.intersection=o);this.intersectedEl&&this.clearCurrentIntersection(),this.intersection=o,this.intersectedEl=n,a.addState(r.HOVERING),n.addState(r.HOVERED),s.twoWayEmit(i.MOUSEENTER)}},onIntersectionCleared:function(e){var t=this.el,n=e.detail.el;t!==n&&n===this.intersectedEl&&this.clearCurrentIntersection()},clearCurrentIntersection:function(){var e=this.el;this.intersectedEl.removeState(r.HOVERED),e.removeState(r.HOVERING),this.twoWayEmit(i.MOUSELEAVE),this.intersection=null,this.intersectedEl=null},twoWayEmit:function(e){var t=this.el,n=this.intersectedEl,i=this.intersection;t.emit(e,{intersectedEl:n,intersection:i}),n&&n.emit(e,{cursorEl:t,intersection:i})}})},function(e,t){var n=AFRAME.utils.styleParser;if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("event-set",{schema:{default:"",parse:function(e){var t=n.parse(e),i={};return Object.keys(t).forEach(function(e){var n=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i[n]=t[e]}),i}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(e){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var e=this.data,t=this.el,n=e._event,i=e._target;delete e._event,delete e._target;var r=i?t.sceneEl.querySelector(i):t;this.eventName=n,this.eventHandler=function(){Object.keys(e).forEach(function(t){AFRAME.utils.entity.setComponentProperty.call(this,r,t,e[t])})}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},function(e,t){AFRAME.registerComponent("browser-controls",{schema:{hand:{default:""}},init:function(){var e,t=this.el;this.body=null,this.trigger=null,this.touchpad=null,this.cursor=null,this.menu=null,this.grip=null,t.addEventListener("model-loaded",function(e){this.body=e.detail.model.getObjectByName("body"),this.trigger=e.detail.model.getObjectByName("trigger"),this.touchpad=e.detail.model.getObjectByName("touchpad"),this.menu=e.detail.model.getObjectByName("menu"),this.grip=e.detail.model.getObjectByName("grip")}.bind(this)),e={hand:this.data.hand,model:!1},t.setAttribute("gltf-model","#controller"),t.setAttribute("vive-controls",e),t.setAttribute("oculus-touch-controls",e)},play:function(){var e=this;["buttonchanged","axismove","touchstart","touchend"].forEach(function(t){e.el.addEventListener(t,e.controllerEvent.bind(e))})},pause:function(){var e=this;["buttonchanged","axismove","touchstart","touchend"].forEach(function(t){e.el.removeEventListener(t,e.controllerEvent)})},controllerEvent:function(e){e.type}})},function(e,t){AFRAME.registerComponent("link-portal",{schema:{bg:{default:""},logo:{default:""}},init:function(){this.el.addEventListener("model-loaded",this.setup.bind(this))},setup:function(e){this.el;this.logoMaterial=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(this.data.logo),transparent:!0}),this.bgMaterial=new THREE.ShaderMaterial({uniforms:{pano:{type:"t",value:THREE.ImageUtils.loadTexture(this.data.bg)},glow:{type:"uFloat",value:0}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader});var t=e.detail.model.getObjectByName("link").children[0],n=e.detail.model.getObjectByName("logo").children[0];t.material=this.bgMaterial,n.material=this.logoMaterial},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying vec3 sphereCenter;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","sphereCenter = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","varying vec3 sphereCenter;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","sampleUV.y = saturate(direction.y * 0.5 + 0.5);","sampleUV.x = atan(direction.z, direction.x) * -RECIPROCAL_PI2 + 0.5;","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(0.93, 0.17, 0.36, 1.0), clamp(pow((vDistance / 10.0), 2.0), 0.0, 1.0));","}"].join("\n")})},function(e,t){AFRAME.registerComponent("simple-link",{schema:{event:{default:""},href:{default:""}},init:function(){var e=this.data;this.el.addEventListener(e.event,function(){window.location.href=e.href+"index.html?backUrl="+window.location.href})}})},function(e,t){AFRAME.registerSystem("simple-link",{init:function(){var e=this.sceneEl,t=this;e.addEventListener("renderstart",function(){function t(){e.enterVR()}navigator.getVRDisplays().then(t)}),window.addEventListener("thumbstickdown",function(){t.back()}),window.addEventListener("menudown",function(){t.back()});var n=function(){var e,t=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(/\+/g," "))},i=window.location.search.substring(1),r={};for(e=t.exec(i);e;)r[n(e[1])]=n(e[2]),e=t.exec(i);return r}();this.backUrl=n.backUrl},back:function(){this.backUrl&&(window.location.href=this.backUrl)}})},function(e,t,n){n(0),n(1),n(2),n(4),n(3),n(5)}]);